# Guía de instalación y gestión de Jenkins en Kubernetes

Este repositorio contiene scripts para la instalación, actualización y desinstalación de Jenkins en un clúster de Kubernetes, utilizando Helm y configuraciones personalizadas. Sigue los pasos a continuación para ejecutar cada script según sea necesario.

## 1. `init.sh` - Inicialización y descarga de imágenes

Este script descarga las imágenes necesarias para Jenkins desde el archivo `config-jenkins.yaml` y las sube al repositorio de Docker Harbor.

### Paso 0: Limpiar instalaciones previas de Jenkins

Ejecuta estos comandos para asegurarte de que no haya instalaciones anteriores de Jenkins:
- `helm uninstall jenkins`
- `kubectl delete pvc jenkins-claim`
- `kubectl delete pv jenkins-pv`

Agrega el repositorio de Bitnami si no lo has hecho:
- `helm repo add bitnami https://charts.bitnami.com/bitnami`

### Uso:
```bash
chmod +x init.sh
./init.sh
```

### Nota:
- Este paso requiere conexión a internet para descargar las imágenes de Docker. Una vez que las imágenes están descargadas y subidas al repositorio, la instalación de Jenkins ya no necesita conexión a internet.

### Descripción:
- Extrae las imágenes de Docker definidas en `config-jenkins.yaml`.
- Descarga las imágenes y las sube al repositorio Harbor.

## 2. `instalar.sh` - Instalación de Jenkins

Este script instala Jenkins en el clúster de Kubernetes utilizando Helm. También realiza la configuración de carpetas en los nodos mediante BOSH y crea los volúmenes necesarios para Jenkins.

### Uso:
```bash
chmod +x instalar.sh
./instalar.sh
```

### Descripción:
- Crea carpetas en los nodos especificados usando BOSH.
- Configura el Persistent Volume y el Persistent Volume Claim.
- Instala Jenkins con el chart de Helm y espera hasta que esté listo.
- Recupera la IP del `LoadBalancer` para acceder a Jenkins.

## 3. `desinstalar.sh` - Desinstalación de Jenkins

Este script desinstala Jenkins del clúster, elimina el PVC y limpia todos los recursos relacionados.

### Uso:
```bash
chmod +x desinstalar.sh
./desinstalar.sh
```

### Descripción:
- Desinstala Jenkins usando Helm.
- Elimina el Persistent Volume Claim (PVC).
- Limpia recursos adicionales de Kubernetes como `services`, `deployments`, `configmaps` y `secrets`.

## 4. `actualizar.sh` - Actualización de Jenkins

Este script actualiza la instalación de Jenkins en el clúster utilizando Helm, aplicando los últimos cambios en el archivo de configuración.

### Uso:
```bash
chmod +x actualizar.sh
./actualizar.sh
```

### Descripción:
- Actualiza Jenkins usando el chart de Helm con la configuración más reciente de `config-jenkins.yaml`.